# Построение ETL-пайплайна

## Задача

У нас есть много разных источников данных, которые используются для расчёта ключевых метрик. Необходимо построить ETL-пайплайн на Airflow, чтобы все источники обрабатывались автоматически без нашего активного участия.  

Для каждого пользователя посчитаем число просмотров и лайков контента, сколько он получает и отсылает сообщений, скольким людям он пишет, сколько людей пишут ему. Для этой таблицы считаем все эти метрики в разрезе по полу, возрасту и ос и записываем в отдельную таблицу в ClickHouse. Каждый день таблица должна дополняться новыми данными с помощью Airflow. 

## Данные

- таблица feed_actions - данные о просмотре постов в ленте:

user_id - уникальный идентификатор пользователя  
post_id - уникальный идентификатор поста в ленте  
action - просмотр или лайк  
time - дата и время  
gender - пол  
age - возраст  
country - страна  
city - город  
os - операционная система  
source - источник трафика, который привёл пользователя в приложение  
exp_group - группа (для A/B-тестов)  

- таблица message_actions - данные об отправке сообщений:

user_id - уникальный идентификатор пользователя-отправителя  
reciever_id - уникальный идентификатор пользователя-получателя  
time - дата и время  
source - источник трафика, который привёл пользователя в приложение  
exp_group - группа (для A/B-тестов)  
gender - пол  
age - возраст  
country - страна  
city - город  
os - операционная система  

## Результат

Создана таблица, в которую ежедневно добавляются данные об активности пользователей.
![image](https://user-images.githubusercontent.com/122831288/231822216-5b8f8366-dc15-4f7c-82ce-453b2afd0a00.png)  
Подробнее [здесь](/etl.py)

## Используемые библиотеки

*pandas*
